## 00 A review of how we got here

* Microservices
* Containers
	* Building and exchanging images
	* Inspecting and starting/stopping images
* Orchestration: [Service Managment, Scheduling, Resource Management]
* Working with real applications
* `Vagrant up` machines into a cluster
* DC/OS GUI and CLI
* Installing a service on DC/OS

## 01 DC/OS - Theory 01 - Basic Concepts

### Key terms to keep in mind:

DC/OS is a distributed OS for the data center built on top of Apache Mesos.

* DC/OS is made up of many components, most notably a distributed systems kernel (Mesos) and a container orchestration engine (Marathon).
* What's not covered in the FOSS version: Enterprise versions include closed-source components and features like multitenancy, fine-grained permissions, secrets management, and end-to-end encryption.

Apache Mesos is a distributed systems kernel that manages cluster resources and tasks.

* Mesos is one of the core components of DC/OS that predates DC/OS itself, bringing maturity and stability to the platform.

**DC/OS builds up on Mesos and uses a lot of similar terminology. It helps to consider the terms in the context of DC/OS as well as Mesos**

#### Nodes

A DC/OS node is a virtual or physical machine on which a Mesos agent and/or Mesos master process runs. DC/OS nodes are networked together to form a DC/OS cluster.

##### Master Node

A DC/OS master node is a virtual or physical machine that runs a collection of DC/OS components that work together to manage the rest of the cluster.

* Each master node contains multiple DC/OS components, including most notably a Mesos master process.
	* A Mesos master is a process that runs on master nodes to coordinate cluster resource management and facilitate orchestration of tasks.
* Master nodes work in a [quorum](https://en.wikipedia.org/wiki/Quorum_%28distributed_computing%29) to provide consistency of cluster coordination. To avoid [split brain](https://en.wikipedia.org/wiki/Split-brain_%28computing%29) cluster partitioning, clusters must have an odd number of master nodes. For example, having three master nodes allows one to be down; having five master nodes allows two to be down, allowing for failure during a rolling update. Additional master nodes can be added for additional risk tolerance.
	* The Mesos masters form a quorum and elect a leader.
	* The lead Mesos master collects resources reported by Mesos agents and makes resource offers to Mesos schedulers. Schedulers then may accept resource offers and place tasks on their corresponding nodes.
* A cluster with only one master node is usable for development, but is not highly available and may not be able to recover from failure.

##### Agent Node

A DC/OS agent node is a virtual or physical machine on which Mesos tasks are run.

* Each agent node contains multiple DC/OS components, including most notably a *Mesos agent* process.
* Agent nodes can be *private* or *public*, depending on agent and network configuration.

* A Mesos agent is a process that runs on agent nodes to manage the executors, tasks, and resources of that node.
* The Mesos agent registers some or all of the node’s resources, which allows the lead Mesos master to **offer those resources** to **schedulers**, which decide on which node to run tasks.
* The Mesos agent reports task status updates to the lead Mesos master, which in turn reports them to the appropriate scheduler.

###### Private Agent Node

A private agent node is an agent node that is on a network that *does not* allow entry or 'ingress' from outside of the cluster via the cluster’s infrastructure networking.

*  The Mesos agent on each private agent node is, by default, configured with none of its resources allocated to any specific Mesos roles.
*  Most service packages install by default on private agent nodes.
*  Clusters are generally comprised of mostly private agent nodes.

###### Public Agent Node

A public agent node is an agent node that is on a network that *does* allow entry or 'ingress' from outside of the cluster via the cluster’s infrastructure networking.

* Public agent nodes are used primarily for externally facing reverse proxy load balancers, like Marathon-LB.
* Clusters generally have only a few public agent nodes, because a single load balancer can handle proxying multiple services.


#### Host Operating System

A host operating system is the operating system that runs on each DC/OS node underneath the DC/OS components, manages the local hardware and software resources, and provides common services for running other programs and services.

* DC/OS currently supports: 
	* [CentOS](https://www.centos.org/), 
	* [RHEL](https://www.redhat.com/en/technologies/linux-platforms/enterprise-linux)
	* [CoreOS](https://coreos.com/).

* While the host OS manges local tasks and machine resources, DC/OS manages cluster tasks and resources so that the user does not generally need to interact with the host operating systems on the nodes.

#### Bootstrap Machine

A bootstrap machine is the machine on which the DC/OS installer artifacts are configured, built, and distributed.

* The bootstrap machine is not technically considered part of the cluster since it does not have DC/OS installed on it (this may change in the future). For most installation methods, the bootstrap node must be accessible to and from the machines in the cluster via infrastructure networking.
* The bootstrap machine is sometimes used as a jumpbox to control SSH access into other nodes in the cluster for added security and logging. *We'll look at the alternative install later today*
* If a bootstrap machine is not required for managing master node IP changes or as an SSH jumpbox, it can be shut down after bootstrapping and spun up on demand to add new nodes to the cluster.

#### Task

A Mesos task is an abstract unit of work, lifecycle managed by a Mesos executor, that runs on a DC/OS agent node.

* Tasks are often processes or threads, but could even just be inline code or items in a single-threaded queue, depending on how their executor is designed.

#### Executor

A Mesos executor is a method by which Mesos agents launch tasks.

* Executor processes are launched and managed by Mesos agents on the agent nodes.
* Mesos **tasks** are defined by their **scheduler** to be run by a specific **executor** (or the default executor).
* Each **executor** runs in its own **container**.

#### Scheduler

A Mesos scheduler is a program that defines new Mesos tasks and assigns resources to them (placing them on specific nodes).

* A scheduler receives resource offers describing CPU, RAM, etc., and allocates them for discrete tasks that can be launched by Mesos agents.
* A **scheduler** must register with Mesos as a **framework**.

#### Framework

A Mesos framework consists of a **scheduler**, **tasks**, and *optionally* **custom executors**.

* *The term framework and scheduler are sometimes used interchangeably. Prefer the term **scheduler**.*

#### Resource Offer

A Mesos resource offer provides a set of unallocated resources (e.g. cpu, disk, memory) from an agent to a scheduler so that the scheduler may allocate those resources to one or more tasks. Resource offers are constructed by the leading Mesos master, but the resources themselves are reported by the individual agents.

Ref: [Application Framework development guide](http://mesos.apache.org/documentation/latest/app-framework-development-guide/).

## 01 DC/OS - Theory 02 - Architecture and Components
* SSH into a master node, then:
```
systemctl | grep dcos-
```

This should list all the components in your DCOS installation.